</html>
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Trending YouTube</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Sharp:opsz,wght,FILL,GRAD@48,400,0,0" />
    <link rel="stylesheet" href="style.css">
    <!-- Three.js -->
    <script src="https://unpkg.com/three@0.130.1/build/three.min.js"></script>
    <!-- three-globe -->
    <script src="https://unpkg.com/three-globe@2.24.11/build/three-globe.min.js"></script>
    <!-- d3 para scale si fuera necesario -->
    <script src="https://unpkg.com/d3@5"></script>

    <!-- three.js core -->
    <script src="https://unpkg.com/three@0.125.2/build/three.min.js"></script>
    <!-- three-globe UMD -->
    <script src="https://unpkg.com/three-globe"></script>
    <!-- TrackballControls UMD -->
    <script src="https://unpkg.com/three@0.125.2/examples/js/controls/TrackballControls.js"></script>

</head>

<body>

    <aside>
        <div class="logo">
            <h2>T<span class="accent">YouTube</span></h2>
        </div>
        <nav>
            <div class="sidebar-item active" data-section="dashboard">
                <span class="material-symbols-sharp">grid_view</span>
                <h3>Dashboard</h3>
            </div>
            <div class="sidebar-item" data-section="about">
                <span class="material-symbols-sharp">info</span>
                <h3>Acerca de</h3>
            </div>
            <div class="sidebar-item" data-section="database">
                <span class="material-symbols-sharp">database</span>
                <h3>Data Base</h3>
            </div>
            <div class="sidebar-item" data-section="analytics">
                <span class="material-symbols-sharp">insights</span>
                <h3>Analytics</h3>
            </div>
            <div class="sidebar-item" data-section="reports">
                <span class="material-symbols-sharp">description</span>
                <h3>Reportes</h3>
            </div>
            <div class="sidebar-item" data-section="logout">
                <span class="material-symbols-sharp">logout</span>
                <h3>Log Out</h3>
            </div>
        </nav>
    </aside>

    <main>
        <!-- Dashboard -->
        <div id="dashboard" class="section active">
            <h2>Bienvenido al Dashboard</h2>
            <p>Contenido principal de la sección Dashboard.</p>

            <div class="highlights">
                <div class="highlight-card yellow">
                    <div class="hc-content">
                        <span id="stat-rows" class="hc-value">--</span>
                        <span class="hc-label">Total registros</span>
                    </div>
                    <span class="material-symbols-sharp hc-icon">storage</span>
                </div>

                <div class="highlight-card blue" id="reactions-card">
                    <div class="hc-content">
                        <span id="stat-likes" class="hc-value">--</span>
                        <span class="hc-label">Likes</span>
                    </div>
                    <span id="reactions-icon" class="material-symbols-sharp hc-icon">thumb_up</span>
                </div>

                <div class="highlight-card green">
                    <div class="hc-content">
                        <span id="stat-views" class="hc-value">--</span>
                        <span class="hc-label">Vistas</span>
                    </div>
                    <span class="material-symbols-sharp hc-icon">visibility</span>
                </div>

                <div class="highlight-card pink">
                    <div class="hc-content">
                        <span id="stat-comments" class="hc-value">--</span>
                        <span class="hc-label">Comentarios</span>
                    </div>
                    <span class="material-symbols-sharp hc-icon">chat_bubble</span>
                </div>

            </div>

            <!-- debajo de .highlights -->
            <div id="globe-container"></div>


            <!-- Acerca de -->
            <div id="about" class="section">
                <h2>Acerca de</h2>
                <p>Información sobre la aplicación.</p>
            </div>

            <!-- Data Base -->
            <div id="database" class="section">
                <h2>Data Base</h2>
                <p>Aquí iría tu visor de CSV/JSON.</p>
            </div>

            <!-- Analytics -->
            <div id="analytics" class="section">
                <h2>Analytics</h2>
                <p>Gráficos y análisis de datos.</p>
            </div>

            <!-- Reportes -->
            <div id="reports" class="section">
                <h2>Reportes</h2>
                <p>Descarga de reportes PDF/PPT.</p>
            </div>

            <!-- Log Out -->
            <div id="logout" class="section">
                <h2>Log Out</h2>
                <p>¿Seguro que deseas cerrar sesión?</p>
            </div>
    </main>

    <script>
        (function () {
            const sidebarItems = document.querySelectorAll('.sidebar-item');
            const pageSections = document.querySelectorAll('.section');

            sidebarItems.forEach(item => {
                item.addEventListener('click', () => {
                    sidebarItems.forEach(i => i.classList.remove('active'));
                    pageSections.forEach(s => s.classList.remove('active'));

                    item.classList.add('active');

                    const targetId = item.getAttribute('data-section');
                    const targetSection = document.getElementById(targetId);
                    if (targetSection) targetSection.classList.add('active');
                });
            });
        })();

        (async function () {
            try {
                const resp = await fetch('../data_limpios/stats.json');
                if (!resp.ok) throw new Error(`HTTP ${resp.status}`);
                const stats = await resp.json();

                document.getElementById('stat-rows').textContent =
                    stats.total_rows.toLocaleString();

                const likesEl = document.getElementById('stat-likes');
                const iconEl = document.getElementById('reactions-icon');
                let showingLike = true;
                likesEl.textContent = stats.total_likes.toLocaleString();

                setInterval(() => {
                    if (showingLike) {
                        iconEl.textContent = 'thumb_down';
                        likesEl.textContent = stats.total_dislikes.toLocaleString();
                    } else {
                        iconEl.textContent = 'thumb_up';
                        likesEl.textContent = stats.total_likes.toLocaleString();
                    }
                    showingLike = !showingLike;
                }, 5000);

                document.getElementById('stat-views').textContent =
                    stats.total_views.toLocaleString();

                document.getElementById('stat-comments').textContent =
                    stats.total_comments.toLocaleString();

            } catch (err) {
                console.error('No se pudieron cargar las estadísticas:', err);
            }
        })();

        window.addEventListener('load', () => {
            const container = document.getElementById('globe-container');

            // 1. Renderer transparente
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(container.offsetWidth, container.offsetHeight);
            renderer.domElement.style.background = 'transparent';
            container.appendChild(renderer.domElement);

            // 2. Escena sin fondo
            const scene = new THREE.Scene();
            scene.background = null;

            // 3. Cámara
            const camera = new THREE.PerspectiveCamera(
                40,
                container.offsetWidth / container.offsetHeight,
                0.1,
                1000
            );
            camera.position.set(0, 0, 400);

            // 4. Controles
            const controls = new THREE.TrackballControls(camera, renderer.domElement);
            controls.minDistance = 200;
            controls.maxDistance = 600;

            // 5. Globo
            const Globe = new ThreeGlobe()
                .globeImageUrl('//unpkg.com/three-globe/example/img/earth-blue-marble.jpg')
                .labelsData([{ lat: 37.09, lng: -95.71, size: 1.5, text: 'United States' }])
                .labelLat(d => d.lat)
                .labelLng(d => d.lng)
                .labelText(d => d.text)
                .labelSize(d => d.size)
                .labelDotRadius(d => d.size)
                .labelColor(() => 'orange');

            // 6. Punto de vista centrado sin “altura” extra
            Globe.pointOfView({ lat: 0, lng: 0, altitude: 3 }, 0);

            scene.add(Globe);

            // 7. Animación
            (function animate() {
                controls.update();
                Globe.rotation.y += 0.0005;
                renderer.render(scene, camera);
                requestAnimationFrame(animate);
            })();

            // 8. Resize
            window.addEventListener('resize', () => {
                camera.aspect = container.offsetWidth / container.offsetHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.offsetWidth, container.offsetHeight);
            });
        });

    </script>


</body>

</html>